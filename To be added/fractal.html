<!DOCTYPE html>
<html>
<body>

<canvas id="myCanvas" width="400" height="346">
Your browser or preview does not support the HTML canvas tag.</canvas>

<script>

function sleep(ms) {
  return new Promise(resolve => setTimeout(resolve, ms));
}

function getMedian(x1,x2){
 return ((x1 + x2)/2);
}

async function drawTriangle(x1,y1,x2,y2,x3,y3,delaySpeed){
	ctx.moveTo(x1,y1);
	ctx.lineTo(x2,y2);
	ctx.stroke();
	await sleep(delaySpeed);
	ctx.moveTo(x2,y2);
	ctx.lineTo(x3,y3);
	ctx.stroke();
	await sleep(delaySpeed);
	ctx.moveTo(x3,y3);
	ctx.lineTo(x1,y1);
	ctx.stroke();
	await sleep(delaySpeed);
}

async function nestTriangle(x1,y1,x2,y2,x3,y3,depth, maxdepth, delaySpeed){
	if (depth < maxdepth) { 
	var sideLength = x3 - x1;
	await sleep(delaySpeed * 3);
	drawTriangle(x1,y1,x2,y2,x3,y3,delaySpeed);
	var a2x = getMedian(x1,x3);
	var a2y = getMedian(y1,y3);
	var a1x = a2x - sideLength;
	var a1y = a2y;
	var a3x = getMedian(a1x,a2x);
	var a3y = a2y + (sideLength * 0.8660254);
	var b3x = getMedian(x1,x2);
	var b3y = getMedian(y1,y2);
	var b1x = b3x - (sideLength/2);
	var b1y = b3y - (sideLength * 0.8660254);
	var b2x = b3x + (sideLength/2);
	var b2y = b1y;
	var c1x = getMedian(x2,x3);
	var c1y = getMedian(y2,y3);
	var c2x = c1x + sideLength;
	var c2y = c1y;
	var c3x = getMedian(c1x,c2x);
	var c3y = c1y + (sideLength * 0.8660254);
	await nestTriangle(a1x,a1y,a2x,a2y,a3x,a3y,(depth + 1),maxdepth,delaySpeed);
	await nestTriangle(b1x,b1y,b2x,b2y,b3x,b3y,(depth + 1),maxdepth,delaySpeed);
	await nestTriangle(c1x,c1y,c2x,c2y,c3x,c3y,(depth + 1),maxdepth,delaySpeed);
	}
}

var c = document.getElementById("myCanvas");
var ctx = c.getContext("2d");
var scaleFactor = 1.00;
var speedFactor = 3.00;
var depthFactor = 6;
ctx.canvas.width = 400 * scaleFactor;
ctx.canvas.height = 346 * scaleFactor;
ctx.moveTo(0,0);
drawTriangle(0 * scaleFactor,346 * scaleFactor,200 * scaleFactor,0 * scaleFactor,400 * scaleFactor,346 * scaleFactor); //bounding box
nestTriangle(100 * scaleFactor,173 * scaleFactor,300 * scaleFactor,173 * scaleFactor,200 * scaleFactor,346 * scaleFactor,0,depthFactor,(100 / speedFactor));

</script>

</body>
</html>
